<!-- CSS -->
<link rel="stylesheet" type="text/css" href="/devwidgets/newinbox/css/newinbox.css" />

<div id="newinbox_widget">

    <!-- WIDGET BODY -->
    <div class="fl-widget-newinbox s3d-widget-newinbox s3d-widget-small-newinbox">
        <div class="newinbox_main">
            <!-- Title -->
            <span class="newinbox_title s3d-bold">__MSG__MESSAGES__</span>
            <span ud="newinbox_title_total_wrapper" style="display:none">(<span id="newinbox_title_total"></span>)</span>
            <!-- Title Bar -->
            <div class="newinbox_title_bar">
                <button type="button" id="newinbox_back_to_messages" class="s3d-button s3d-button-link-2-state" style="display:none">
                    <span class="s3d-button-inner s3d-button-link-2-state-inner">__MSG__BACK_ICON__ __MSG__BACK_TO_MESSAGES__</span>
                </button>
                <a href="#newmessage=true" data-remove-params="message, reply" class="s3d-button s3d-button-link-2-state fl-force-right" id="newinbox_create_new_message">
                    <span class="s3d-button-inner s3d-button-link-2-state-inner" data-state="default">__MSG__CREATE_NEW_MESSAGE__</span>
                </a>
            </div>

            <!-- Inbox Items -->
            <div id="newinbox_message_list" style="display:none"></div>

            <!-- Inbox Item Template -->
            <div id="newinbox_message_list_item_template"><!--
                {for message in data.results}
                    <div class="fl-container fl-fix newinbox_items_container{if message.read !== "true"} unread{/if}{if message_index == data.results.length-1} last{/if}" id="${message.id}">
                        <div class="newinbox_items_inner">
                            <div class="newinbox_delete">
                              <button type="button" class="s3d-button s3d-button-link-2-state newinbox_reply_button">
                                <span class="s3d-button-inner s3d-button-link-2-state-inner">__MSG__REPLY_ICON__</span>
                              </button>
                              <button type="button" class="s3d-button s3d-button-link-2-state newinbox_delete_button">
                                <span class="s3d-button-inner s3d-button-link-2-state-inner">__MSG__X__</span>
                              </button>

                            </div>
                            <div class="newinbox_placeholder"><input type="checkbox"/></div>
                            <div class="newinbox_message_data">
                              <a href="#message=${message.id}"><img alt="person icon" src="${message.from.picture}"/></a>
                              <div class="newinbox_name">
                                <a href="#message=${message.id}" class="s3d-regular-links s3d-bold">${message.from.name}</a>
                              </div>
                              <div class="newinbox_date">
                                <span>${message.date}</span>
                              </div>
                              <div class="newinbox_subject">
                                <a href="#message=${message.id}" class="s3d-regular-links s3d-bold">${message.subject}</a>
                              </div>
                              <div class="newinbox_excerpt">
                                <p>${message.nolinebreaks}<p>
                              </div>
                            </div>
                        </div>
                    </div>
                {forelse}
                    <div class="fl-container fl-fix" id="newinbox_no_messages">
                        <p>__MSG__NO_MESSAGES__</p>
                    </div>
                {/for}
            --></div>
            <div id="newinbox_pager" class="jq_pager"></div>

            <!-- Message show pane -->
            <div id="newinbox_show_message" style="display:none"></div>
            <div id="newinbox_show_message_template"><!--
                {macro showMessage(message, reply)}
                  <div class="newinbox_message_container{if reply} reply{/if}">
                    <div class="newinbox_show_message_header">
                        <div class="fl-container fl-fix newinbox_items_container" id="${message.id}">
                            <div class="newinbox_items_inner">
                                {if !reply}
                                <div class="fl-force-right">
                                    <button type="button" class="s3d-button s3d-button-link-2-state newinbox_delete_button">
                                        <span class="s3d-button-inner s3d-button-link-2-state-inner">__MSG__X__</span>
                                    </button>
                                </div>
                                {/if}
                                <div class="newinbox_placeholder">&nbsp;</div>
                                <img alt="person icon" src="${message.from.picture}"/>
                                <div class="newinbox_name">
                                  <a href="#" class="s3d-regular-links s3d-bold">${message.from.name}</a>
                                </div>
                                <div class="newinbox_date">
                                  <span>${message.date}</span>
                                </div>
                                <div class="newinbox_subject">
                                  <a href="#" class="s3d-regular-links s3d-bold">${message.subject}</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="newinbox_show_message_body">
                        <p>${message.body}</p>
                        {if message.invited === true}
                          <button class="newinbox_invitation newinbox_invitation_accept s3d-link-button">__MSG__ACCEPT_INVITATION__</button>
                          <button class="newinbox_invitation newinbox_invitation_ignore s3d-link-button">__MSG__IGNORE_INVITATION__</button>
                        {elseif message.ignored === true}
                          __MSG__IGNORED__
                        {else}
                          __MSG__ACCEPTED__
                        {/if}
                    </div>
                  </div>
                  {if !reply}
                    <div id="newinbox_show_message_reply">
                      <a href="#reply=true">__MSG__REPLY__</a>
                        <div class="newinbox_show_message_reply_fields"></div>
                    </div>
                  {/if}
                  {if reply && message.previousMessage}
                      ${showMessage(message.previousMessage, true)}
                  {/if}
                {/macro}

                <div id="newinbox_show_message_main">
                  ${showMessage(message)}
                </div>
                {if message.previousMessage}
                <h2>__MSG__PREVIOUS_MESSAGES__</h2>
                <div id="newinbox_show_message_replies">
                      ${showMessage(message.previousMessage, true)}
                </div>
                {/if}
            --></div>

            <!-- New Message -->
            <div id="newinbox_new_message" style="display:none"></div>
        </div>
    </div>

    <div class="s3d-widget-no-options">
        <div class="s3d-widget-no-options-inner">
        </div>
    </div>
</div>

<script type="text/javascript" src="/devwidgets/newinbox/javascript/newinbox.js"></script>
