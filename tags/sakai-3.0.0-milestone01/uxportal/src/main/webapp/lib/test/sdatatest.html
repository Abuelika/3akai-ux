<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<title>Untitled Document</title>
		<script src="../sdata.js" type="text/javascript" ></script>
		<script>
			function assert(message,expected,actual) {
				// need coercion so != 
				if ( expected != actual ) {
					alert(message);
				}
			}
			function testParse(){
				var bundleLocations = {
					ALL: "bundle/default.i18n.json",
					en_US: "bundle/en_US.i18n.json"
				};
				var defaultLocale = "ALL";
				var inputSet = document.getElementById("input_container");
				var childNodes = inputSet.childNodes;
				for ( var i = 0; i < childNodes.length; i++ ) {
					var node = childNodes[i];
					
					if (node.className === "testinput") {
						var testcase = node.value || node.innerHTML;
						sdata.i18n.process(testcase, 
						function(localeized){
							document.getElementById("output_container").innerHTML += "<div class=\"before\" >" + testcase + "</div><div class=\"after\" >" + localeized + "</div>";
						}, bundleLocations, defaultLocale);
					}
					
				}
				
			};
			
			function testParseHtml() {
				// find link in either order
				var widget = " <link src=\"en_US\" type=\"messagebundle/json\" hreflang=\"en_US\"  > </link>  <link src=\"ignore\" type=\"Type\" /> <link type=\"messagebundle/json\" src=\"default\" />  ";
				var links =  sdata.widgets.WidgetLoader.getLinks("link",widget);
				
				var bundle = sdata.i18n.getBundles(widget);				
				var finalBundle = bundle["en_US"];
				var finalBundleDefault = bundle["default"];
				
			};
			
			
			function testIgnoreJS(){
				assert("testIgnoreJS Test1 Failed",true,sdata.widgets.WidgetLoader.acceptJS("dsdfsdf/sdfsdfs/sdfsdfsdf/sdfsdfsd"));
				assert("testIgnoreJS Test2 Failed",false,sdata.widgets.WidgetLoader.acceptJS("lib/sdfsdfs/sdfsdfsdf/sdfsdfsd"));
				assert("testIgnoreJS Test3 Failed",false,sdata.widgets.WidgetLoader.acceptJS("/lib/sdfsdfs/sdfsdfsdf/sdfsdfsd"));
				assert("testIgnoreJS Test4 Failed",true,sdata.widgets.WidgetLoader.acceptJS("dev/sdfsdf/sdfsdfs/sdfsdfsdf/sdfsdfsd"));
				assert("testIgnoreJS Test5 Failed",false,sdata.widgets.WidgetLoader.acceptJS("dev/lib/sdfsdfs/sdfsdfsdf/sdfsdfsd"));
				assert("testIgnoreJS Test6 Failed",false,sdata.widgets.WidgetLoader.acceptJS("/dev/lib/sdfsdfs/sdfsdfsdf/sdfsdfsd"));
			}
				
			function testSuite() {
				testParse();
			};
			//sdata.events.Listener.onLoad(function() { testSuite(); });

		</script>
		<style type="text/css" >
			.before {
				border: solid 1px red;
			}
			.after {
				border: solid 1px green;
			}
		</style>
	</head>
	
	<body>
		<dir id="input_container">
			<p>input1</p>
			<p id="input1" class="testinput" >In __MSG__capital__ we spend __MSG__currency__</p>
			<textarea id="input2"  class="testinput"></textarea>			
		</dir>
		<div id="output_container"></div>
		
		<button onclick="testSuite();" value="RunTest" >RunTest</button>
		<button onclick="testParseHtml();" value="TestParse" >TestParse</button>
		<button onclick="testIgnoreJS();" value="testIgnoreJS" >testIgnoreJS</button>
	</body>
</html>
