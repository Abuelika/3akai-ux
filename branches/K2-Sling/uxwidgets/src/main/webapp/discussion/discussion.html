<!-- CSS -->
<link rel="stylesheet" type="text/css" href="/devwidgets/discussion/css/discussion.css" />

<!-- MAIN VIEW -->
<div id="discussion_main_container" style="display:none">
	<h3>Discussion</h3>
	
	<!-- MAIN CONTAINER FOR DISCUSSIONS -->
	<div id="discussion_container">

	</div>
	<div id="discussion_container_template" style="display:none"><!--
	{var close = false}
	{for i in posts}
		{if i_index==0}
			<div id="discussion_first">
		{elseif i_index >= 1 && i.firstReply == true}
			${close = true|eat}
			<div class="discussion_posts">
		{/if}

		<div class="discussion_post" id="discussion_post${i.postId}">
			<div class="discussion_header">
				<div class="discussion_left">
					{if loggedIn}
						{if i.picture != ""}
							<img alt="avatar" class="discussion_avatar" src="${i.picture}" style="float:left" />
						{else}
							<img alt="avatar" class="discussion_avatar" src="/dev/_images/person_icon.png" style="float:left" />
						{/if}
						<p class="discussion_content_subject" id="discussion_content_subject_${i.postId}" style="margin-bottom: 0px; font-size: 1.2em">${i.subject}</p>
						<a href="/dev/profile.html?user=${i.uid}"><span class="discussion_username">${i.name}</span></a>
						<span class="discussion_date">posted this on ${i.date}</span>
						{if i.editedBy != ""}
						    (<a href="/dev/profile.html?user=${i.editedBy}"><span class="discussion_username_edited">${i.editedByName}</span></a>
							<span class="discussion_date">edited this on ${i.editedByDate}</span>)
						{/if}
					{else}
						<span class="discussion_posted_container">
							<span class="discussion_date">Posted on ${i.date}</span>
						</span>
					{/if}
				</div>
				<span class="discussion_right">
					<span class="discussion_totalReplies">${i.replies}</span>
					{if i.replies == 1}
						<span class="discussion_countReplies"> reply </span>
					{else}
						<span class="discussion_countReplies"> replies </span>
					{/if}
					{if i.replies > 0}
						<span class="discussion_showAllContainer"> 
						(<a class="discussion_toggle_showhideall" id="discussion_toggle_showhideall_${i.postId}" href="javascript:;">
							<span id="discussion_toggle_hideall_${i.postId}">Hide all</span>
							<span class="discussion_toggle_showall" id="discussion_toggle_showall_${i.postId}">Show all</span>
						</a>)
						</span>
					{/if}
				</span>
			</div>
			<div class="discussion_content">
				<div id="discussion_content_container_${i.postId}">
					
					<div id="discussion_content_message_${i.postId}" class="discussion_content_message">${i.body}</div>
				</div>
				{if loggedIn}
					<div id="discussion_content_actions_${i.postId}" class="discussion_content_actions link">
						<ul> 
							<li class="discussion_content_no_border"><a id="discussion_content_reply_${i.postId}" class="discussion_content_reply" href="javascript:;">Reply</a></li>
							{if i.showEdit}
							<li><a id="discussion_content_edit_${i.postId}" class="discussion_content_edit" href="javascript:;">Edit</a></li>
							{/if}
							{if i.showDelete}
		 					<li><a id="discussion_content_delete_${i.postId}" class="discussion_content_delete" href="javascript:;">Delete</a></li>
							{/if}
						</ul>
					</div>
				{/if}
			</div>
		</div>
		
		{if i_index==0}
			</div>
		{/if}
		{if i_index >= 1 && i.lastReply == true}
			{for j in i.countCloseDivs}
				</div>
			{/for}
		{/if}
	{forelse}
		<div id="discussion_no_posts">
			There are no posts available.
		</div>
	{/for}
	{if close}
		</div>
	{/if}
--></div>
	
	<!-- EDIT CONTAINER -->
	<div id="discussion_edit_container" style="display:none;">
		<form>
			<input type="text" id="discussion_edit_subject" /><br />
			<textarea id="discussion_edit_message" rows="0" cols="0"></textarea><br />
			<div class="buttonBar">
				<a class="button-default save_button" href="javascript:;" id="discussion_edit_save" style="float:left;">Save</a>
				<a class="button cancel-button" href="javascript:;" id="discussion_edit_cancel" style="margin-left:10px;">Cancel</a>
			</div>
		</form>
	</div>

	<!-- REPLY CONTAINER -->
	<div id="discussion_reply_container" style="display:none;">
		<form>
			<label for="discussion_reply_subject">Subject</label>
			<input type="text" id="discussion_reply_subject" /><br />
			<label for="discussion_reply_body">Body</label>
			<textarea id="discussion_reply_body"></textarea><br />
			
			<div class="dialog_footer">
				<div class="buttonBar">
					<a class="button-default submit_button" href="javascript:;" id="discussion_reply_submit" style="float:left;">Reply</a>
					<a class="button cancel-button" href="javascript:;" id="discussion_reply_cancel" style="margin-left:10px;">Cancel</a>
				</div>
			</div>
		</form>
	</div>
</div>

<!-- SETTINGS VIEW -->
<div id="discussion_settings" style="display:none">
	<form>
		<ul class="discussion_settings_tabs">
			<li>
				<a class="discussion_settings_tab_selected" href="javascript:;" id="discussion_settings_new_tab">Post New</a>
			</li>
			<li>
				<a class="discussion_settings_tab" href="javascript:;" id="discussion_settings_existing_tab">Insert Existing</a>
			</li>
		</ul>
		
		<div id="discussion_settings_new_container" class="discussion_settings_container">
			<form>
				<label for="discussion_settings_new_subject">Subject</label><br />
				<input type="text" id="discussion_settings_new_subject" /><br />
			
				<label for="discussion_settings_new_body">Body</label><br />
				<textarea id="discussion_settings_new_body"></textarea><br />
			</form>
		</div>
		<div id="discussion_settings_existing_container" class="discussion_settings_container" style="display:none;">
			<div id="discussion_no_discussions">
				You don't have any discussions yet.
			</div>
		</div>
		<div id="discussion_settings_existing_container_template" ><!--
			<label>Select existing discussion</label>
			{if items.length == 0}
				<span>You don't have any discussions yet.</span>
			{else}
			<div class="discussion_settings_list">
				{for i in items}
					<div id="discussion_settings_list_item_${i.tuid}" class="discussion_settings_list_item">
						${i.subject}
					</div>
				{/for}
			</div>
			{/if}
		--></div>
		<div class="dialog_footer">
			<div class="buttonBar">
				<a class="button-default submit_button" href="javascript:;" id="discussion_settings_submit" style="float:left;">Submit</a>
				<a class="button cancel-button" href="javascript:;" id="discussion_settings_cancel" style="margin-left: 10px;">Cancel</a>
			</div>
		</div>
	</form>
</div>

<!-- JAVASCRIPT -->
<script type="text/javascript" language="JavaScript" src="/devwidgets/discussion/javascript/discussion.js"></script>